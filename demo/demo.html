<!DOCTYPE html>
<html>

<head>
    <title></title>
</head>

<body>
    <style>
/*      .fade {
        display:block;
      }*/
      .riot-animate .fade{
        transition:0.5s linear all;
      }

      .riot-enter .fade  {
        transition:1s linear all;
        opacity:0;
      }

      .riot-enter.riot-enter-active .fade ,
      .fade.riot-leave {
          opacity:1;
      }

      .riot-leave.riot-leave-active .fade {
          opacity:0;
      }

    </style>
    <timer></timer>
    <script>
    /**
     * Provides requestAnimationFrame in a cross browser way.
     * @author paulirish / http://paulirish.com/
     */

    if (!window.requestAnimationFrame) {

        window.requestAnimationFrame = (function() {

            return window.webkitRequestAnimationFrame ||
                window.mozRequestAnimationFrame ||
                window.oRequestAnimationFrame ||
                window.msRequestAnimationFrame ||
                function( /* function FrameRequestCallback */ callback, /* DOMElement Element */ element) {

                    window.setTimeout(callback, 1000 / 60);

                };

        })();

    }

    var pfx = ["webkit", "moz", "MS", "o", ""];

    function on(element, type, callback) {
        for (var p = 0; p < pfx.length; p++) {
            if (!pfx[p]) type = type.toLowerCase();
            element.addEventListener(pfx[p] + type, callback, false);
        }
    }

    var OptsAnimateMixin = {
        init: function() {
            var self = this

            this.on('mount', function() {
                console.log('mounted', this);
                self.root.classList.add('riot-enter');
                window.requestAnimationFrame(function() {
                    self.root.classList.add('riot-animate');
                    self.root.classList.add('riot-enter-active');
                });

                this.root.addEventListener("transitionend", function() {
                    self.root.classList.remove('riot-enter-active');
                    self.root.classList.remove('riot-enter');
                    self.root.classList.remove('riot-animate');
                }, false);

            });

            this.on('unmount', function() {

                window.requestAnimationFrame(function() {
                    self.root.classList.add('riot-leave');
                });

                window.requestAnimationFrame(function() {
                    self.root.classList.add('riot-leave-active');
                });

                on(this.root, "AnimationEnd", function() {
                    self.root.classList.remove('riot-leave-active');
                    self.root.classList.remove('riot-leave');
                }, false);

            });
        }
    };
    </script>
    <script type="riot/tag">
        <timer>
          <p class="fade">Seconds Elapsed: { time }</p>

          this.time = opts.start || 0

          tick() {
            this.update({ time: ++this.time })
          }

          var timer = setInterval(this.tick, 1000)

          this.on('unmount', function() {
            clearInterval(timer)
          });

            // setTimeout(function(){
            //   this.unmount('timer');
            // }.bind(this),3000);

          this.mixin(OptsAnimateMixin);
        </timer>
    </script>
    <script src="../node_modules/riot/riot+compiler.js"></script>
    <script>
    riot.mount('timer', {
        start: 0
    });
    </script>
</body>

</html>
